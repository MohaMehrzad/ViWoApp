// Top-level build file where you can add configuration options common to all sub-projects/modules.

buildscript {
  repositories {
    google()
    mavenCentral()
  }
  dependencies {
    classpath('com.android.tools.build:gradle')
    classpath('com.facebook.react:react-native-gradle-plugin')
    classpath('org.jetbrains.kotlin:kotlin-gradle-plugin')
  }
}

allprojects {
  repositories {
    google()
    mavenCentral()
    maven { url 'https://www.jitpack.io' }
  }
  
  configurations.all {
    resolutionStrategy {
      // Force use of stable lint versions compatible with AGP 8.x
      force 'com.android.tools.lint:lint-gradle:31.7.2'
      force 'com.android.tools.lint:lint:31.7.2'
      force 'com.android.tools.lint:lint-api:31.7.2'
      force 'com.android.tools.lint:lint-checks:31.7.2'
      force 'com.android.tools.lint:lint-model:31.7.2'
      
      // Exclude problematic transitive dependencies
      eachDependency { details ->
        if (details.requested.group == 'com.android.tools.lint' && 
            details.requested.version == '31.11.0') {
          details.useVersion '31.7.2'
          details.because 'Version 31.11.0 does not exist, using 31.7.2 instead'
        }
      }
    }
  }
}

subprojects {
  afterEvaluate { project ->
    if (project.hasProperty('android')) {
      project.android {
        lintOptions {
          checkReleaseBuilds false
          abortOnError false
        }
      }
    }
    
    // Disable all lint tasks to avoid missing lint-gradle dependency
    project.tasks.configureEach { task ->
      if (task.name.contains('lint') || task.name.contains('Lint')) {
        task.enabled = false
      }
    }
  }
}

apply plugin: "expo-root-project"
apply plugin: "com.facebook.react.rootproject"
